##########################
# Skripte
##########################

restart_ha:
  alias: Restart Home Assistant
  sequence:
    - alias: Restart Home Assistant
      service: homeassistant.restart

reload_automations:
  alias: Reload Automations
  sequence:
    - alias: Reload-Automations
      service: automation.reload

reboot_pi:
  alias: Reboot System
  sequence:
    - service: homeassistant.turn_off
    - service: shell_command.pi 

# Turns lights on and off after sunset
vacation_lights:
  alias: Vacation Light Mode
  sequence:
    # wait an hour after sunset
    - delay:
        hours: 1
    # turn lights on for 2 hours after sunset
    - service: switch.turn_on
      entity_id: light.lampe_fernseher
    - delay:
        hours: 2
    # turn lights off and wait 2 hours
    - service: switch.turn_off
      entity_id: light.lampe_fernseher
    - delay:
        hours: 2    
    # turn lights on for 30 more minutes
    - service: switch.turn_on
      entity_id: light.lampe_fernseher
    - delay:
        minutes: 30
    # turn lights off
    - service: switch.turn_off
      entity_id: light.lampe_fernseher

# Inspired by https://github.com/Tommatheussen/Home-Assistant-Configuration/blob/master/script/get_latest_config.yaml
get_latest_config:
  alias: 'Get Latest Config'
  sequence:
    - service: shell_command.git_pull

restart_music:
  alias: 'Restart Music'
  sequence:
    - service: shell_command.restart_forked_daapd

turn_off_livingroom_delay_15:
  alias: 'Turn off livingroom (delay 15 minutes)'
  sequence:
    - delay:
        minutes: 15
    - service: homeassistant.turn_off
      entity_id: group.wohnzimmer

turn_off_bedroom_delay_45:
  alias: 'Turn off bedroom (delay 45 minutes)'
  sequence:
    - delay:
        minutes: 45
    - service: homeassistant.turn_off
      entity_id: group.schlafzimmer

turn_tv_on:
  sequence:
    - service: broadlink.send_packet_192_168_178_51
      data:
        packet: 
          - 'JgDSAJWTEzYSOBM3ExETERMSExETERM3EzcTNhMSEhITERMSExETNxMRExETNxM2ExITERM3ExETNxI3ExISEhQ1EzcTERMABf+VkxQ2EzYUNhMRExITERQQExITNhM3EzcTERMRExITERMREzcTERMSEzYTNxMRExETNxMRFDYTNxISExETNxM2ExITAAX/lZMTNRQ3EzYTEhQQExITERMREzcTNhM3ExETEhMRExETEhM2ExITERM3EzYTEhMREzYUERM2EzcTERMSEzYTNxMREwANBQAAAAAAAA=='
          
turn_tv_off:
  sequence:
    - service: broadlink.send_packet_192_168_178_51
      data:
        packet: 
          - 'JgDSAJaUEzYTNxI4EhISEhMSERMRExI4EjgSNxMSEBQSEhITEBQRExITERMRNhU3EhMQFBI3EzcSOBM2EhMRExI3EjgSEhIABgCUlBI4EzYUNhITERMSEhITEBQSNxM3EjgTERISEhMRExISERQRExISEjgSOBMRERMRORI3EzcTNxETERMRORI3ExISAAYAlJQTNhI4EzYUERISEhMRExISEjgSNxM3EhISExETEhITEhETEhMRExI3EjgTERITETgSOBI3EzcSEhITETgTNxISEgANBQAAAAAAAA=='

turn_receiver_on:
  sequence:
    - service: broadlink.send_packet_192_168_178_51
      data:
        packet: 
          - 'JgBQAAABKJMUERQ1FBEVERQ1FBEUNRQ2FDUUERQ1FTUUERQ1FDYUERQRFBEUNRQSFBEUERQRFBEUNRQ2FBEUNRQ1FDYUNRQ1FQAFAgABKEgUAA0FAAAAAAAAAAA='

turn_receiver_off:
  sequence:
    - service: broadlink.send_packet_192_168_178_51
      data:
        packet: 
          - 'JgBQAAABJpQTExI3EhMVEBM2ExMSNxI3FBEVERQ1EjcTEhM3EjcTEhM2EzcSNxMSFBESFBI3EhMTEhMSExIUNhI3EzYTEhM3EgAFKAABJ0oSAA0FAAAAAAAAAAA='

input_hdmi:
  sequence:
    - service: broadlink.send_packet_192_168_178_51
      data:
        packet:
          - 'JgDSAJOVFDUUNhQ2FBAVDxIUERISEhQ2EzcTNhQRExEQFBAVERMRORETERMSORIREzcUNRQ2FBAUNhM2FRATNhMSEBQRExEABgKUkxM3FDUUNhQQFBETERMSFBAPOhE5ETkRFBIREhMSEhITEjcRExEUEjcRFBE5EjcTNhQRDjsRORETEjgRExEUEhISAAYAlJQROBE6ETgSEhETERQSEhMRFDYTNhQ2FQ8UERQRERISExM2ExISEhI4ExIROBI3FDYTEhE4EjcRFBI3EhMSEhETFQANBQAAAAAAAA=='

input_tv:
  sequence:
    # switch on TV and change input
    - service: broadlink.send_packet_192_168_178_51
      data:
        packet:
          - 'JgDSAJSUEjgSNxM3EhISExISEhIRFBI3EjgSNxITERMSExETEhISOBI3ExISNxI4EhISExETERMSExI3ERQRExI4ETgSOBEABgGUlBM2EjYUNxMSERMSExISEhISOBI3EjgTERITERMSEhITETgSOBISEjgSNxITEhIRExITEhISOBISEhISOBI4EjcSAAYAlJQSOBI3EzcSEhITEBQSEhITETgSOBI3EhMRExISEhMSEhI4EzYRFBE4EjgSEhITERMSEhITETgSExETEjcSOBI4EgANBQAAAAAAAA=='
          - 'JgBQAAABKJMUERQ1FREUERQ1FBEUNRQ2FDUUERU0FTUUERQ1FTUUERQ1FBEVEBU1FBEUERQRFBEVEBU1FDUUERU0FTUUNRQ1FQAFAgABKEgUAA0FAAAAAAAAAAA='
    - service: script.turn_on
      entity_id: script.reset_media

input_apple_tv:
  sequence:
    #- service: script.turn_on
    #  entity_id: script.turn_tv_on
    - service: broadlink.send_packet_192_168_178_51
      data:
        packet: 
          - 'JgBQAAABKJMUERQ1FBEVEBU1FBEUNRQ2FDUUERU0FDYUERQ1FTUUERQ1FDUUNhQ1FBEVEBURFBEUERQRFBEUERQ1FDYUNRQ1FQAFAgABKEgUAA0FAAAAAAAAAAA='
    # switch to input HDMI
    - service: script.turn_on
      entity_id: script.input_hdmi
    - service: script.turn_on
      entity_id: script.reset_media

input_plex:
  sequence:
    - service: switch.turn_on
      entity_id: switch.server
    - service: script.turn_on
      entity_id: script.input_apple_tv
    - service: script.turn_on
      entity_id: script.reset_media

input_fire_tv:
  sequence:
    #- service: script.turn_on
    #  entity_id: script.turn_tv_on
    - service: broadlink.send_packet_192_168_178_51
      data:
        packet:
          - 'JgBQAAABKZIUERU1FBEUERQ1FBEVNRQ1FDUUEhQ1FDUUERU1FDUUERQ2FBEUNRQ1FBIUERQRFBEUERQ1FBEVERQ1FDUUNRU1FAAFAgABKEkUAA0FAAAAAAAAAAA='
    # switch to input HDMI
    - service: script.turn_on
      entity_id: script.input_hdmi
    - service: script.turn_on
      entity_id: script.reset_media

input_music:
  sequence:
    - service: broadlink.send_packet_192_168_178_51
      data:
        packet:
          # change input to AppleTV
          - 'JgBQAAABKJMUERQ1FBEVEBU1FBEUNRQ2FDUUERU0FDYUERQ1FTUUERQ1FDUUNhQ1FBEVEBURFBEUERQRFBEUERQ1FDYUNRQ1FQAFAgABKEgUAA0FAAAAAAAAAAA='
    - service: script.turn_on
      entity_id: script.turn_tv_off
    - service: script.turn_on
      entity_id: script.reset_media


reset_media:
  sequence:
    - service: input_select.select_option
          data:
            entity_id: input_select.tv_mode
            option: INIT 